{{ define "tracker" }}
<div id="tracker-grid" class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full mb-8">
    <!-- Player 1 (Starts initially) -->
    <div class="player-card bg-slate-800 border border-slate-700 rounded-xl overflow-hidden shadow-xl" data-player="1">
        <div class="bg-gradient-to-r from-blue-600/20 to-blue-400/10 p-4 border-b border-slate-700">
            <h3 class="text-white font-bold text-sm uppercase tracking-wider flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-blue-500"></span>
                Mano
            </h3>
        </div>
        <div class="p-3 space-y-2">
            <div class="action-btn p-2 rounded-lg bg-slate-900/50 border border-slate-700/30 text-slate-300 text-xs font-medium cursor-pointer transition-all hover:bg-slate-700/50 hover:border-slate-500/50 select-none"
                data-action="1" hx-get="/next-player" hx-target="#tracker-grid" hx-swap="beforeend"
                hx-trigger="click once">
                Juega
            </div>
            <div class="action-btn p-2 rounded-lg bg-slate-900/50 border border-slate-700/30 text-slate-300 text-xs font-medium cursor-pointer transition-all hover:bg-slate-700/50 hover:border-slate-500/50 select-none"
                data-action="2" hx-get="/next-player" hx-target="#tracker-grid" hx-swap="beforeend"
                hx-trigger="click once">
                Canta Truco
            </div>
            <div class="action-btn p-2 rounded-lg bg-slate-900/50 border border-slate-700/30 text-slate-300 text-xs font-medium cursor-pointer transition-all hover:bg-slate-700/50 hover:border-slate-500/50 select-none"
                data-action="3" hx-get="/next-player" hx-target="#tracker-grid" hx-swap="beforeend"
                hx-trigger="click once">
                Al mazo
            </div>
            <div class="action-btn p-2 rounded-lg bg-slate-900/50 border border-slate-700/30 text-slate-300 text-xs font-medium cursor-pointer transition-all hover:bg-slate-700/50 hover:border-slate-500/50 select-none"
                data-action="4" hx-get="/next-player" hx-target="#tracker-grid" hx-swap="beforeend"
                hx-trigger="click once">
                Canta envido
            </div>
        </div>
    </div>
</div>

<style>
    .action-btn.selected {
        background-color: rgba(59, 130, 246, 0.4) !important;
        border-color: rgba(59, 130, 246, 0.6) !important;
        color: white !important;
        box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
    }
</style>

<script>
    // Event delegation to handle clicks on action-btn for both static and dynamic elements
    document.getElementById('tracker-grid').addEventListener('click', (e) => {
        const btn = e.target.closest('.action-btn');
        if (!btn) return;

        const card = btn.closest('.player-card');
        if (!card) return;

        // Remove selected class from all buttons in THIS card
        card.querySelectorAll('.action-btn').forEach(b => b.classList.remove('selected'));
        // Add selected class to the clicked button
        btn.classList.add('selected');

        console.log(`Player card selected action: ${btn.dataset.action}`);
    });
</script>
{{ end }}