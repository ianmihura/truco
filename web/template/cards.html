{{ define "cards" }}
<div id="card-selector-overlay"
    class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-200"
    onclick="this.remove()">
    <div class="bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6 space-y-6"
        onclick="event.stopPropagation()">
        <div class="flex items-center justify-between border-b border-slate-700 pb-4">
            <h2 class="text-xl font-bold text-white tracking-tight">Selecciona una carta</h2>
            <button class="text-slate-400 hover:text-white transition-colors"
                onclick="document.getElementById('card-selector-overlay').remove()">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>

        <div class="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-3">
            {{ range .Cards }}
            {{ $card := printf "%d%c" .N .S }}
            <div class="card-option bg-slate-900 border border-slate-700 rounded-lg p-3 flex flex-col items-center justify-center cursor-pointer transition-all hover:scale-105 hover:bg-slate-700 hover:border-blue-500 group"
                data-card="{{ $card }}" hx-post="/track-act?action=play&card={{ $card }}&state={{ $.State }}"
                hx-target="#tracker-grid" hx-swap="beforeend"
                hx-on:click="const btn = document.querySelector('.active-play'); if(btn) { btn.innerText = 'PLAY: ' + this.dataset.card; btn.classList.add('bg-blue-600/30', 'border-blue-500/50', 'text-white'); btn.closest('.player-card').classList.add('pointer-events-none', 'opacity-60'); btn.classList.remove('active-play'); } document.getElementById('card-selector-overlay').remove()">
                <div class="text-lg font-bold text-slate-200 group-hover:text-blue-400">{{ $card }}</div>
            </div>
            {{ end }}
        </div>
    </div>
</div>
{{ end }}